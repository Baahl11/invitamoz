"use strict";(self.legacyJsonp=self.legacyJsonp||[]).push([["51723"],{95664:function(e,n,t){t.d(n,{$K:function(){return r},dh:function(){return o},ry:function(){return a},xX:function(){return l}});var o=function(e){return/instagram/i.test(e||"")},a=function(e){return o(e)||/facebook/i.test(e||"")||/line/i.test(e||"")||/wechat/i.test(e||"")},i="[Pinterest/Android]",r=function(e){return(e||"").includes("[Pinterest/iOS]")||(e||"").includes(i)},l=function(e){return(e||"").includes(i)}},331357:function(e,n,t){t.d(n,{J:function(){return u},U:function(){return S}});var o,a=t(27399),i=t(767415);function r(e,n,t,o,a,i,r){try{var l=e[i](r),u=l.value}catch(e){return void t(e)}l.done?n(u):Promise.resolve(u).then(o,a)}function l(e){return function(){var n=this,t=arguments;return new Promise(function(o,a){var i=e.apply(n,t);function l(e){r(i,o,a,l,u,"next",e)}function u(e){r(i,o,a,l,u,"throw",e)}l(void 0)})}}var u="nic_v4",s="".concat(u,"=1a"),d="".concat(u,"=1b"),c=[s,d],p=["invite_code","invite","board_invite_code","sender"],_=null,m=function(e){return!!p.find(function(n){return e.includes(n)})},v=function(e){var n;return e.pathname.includes("/pin/")&&!m(e.search)&&(n=e.search,!c.find(function(e){return n.includes(e)}))},g=(o=l(regeneratorRuntime.mark(function e(n){var t,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.Z.create("InviteSocialTrackingParamNonInviteResource",{user_id:n}).callCreate();case 2:if(!(t=e.sent.resource_response)){e.next=11;break}return o=encodeURIComponent(t.data),(0,i.nP)("".concat(u,".social_tracking_pin_non_invite.encrypted.").concat(o?"true":"false")),e.abrupt("return",o);case 11:return(0,i.nP)("".concat(u,".social_tracking_pin_non_invite.no_resource_response")),e.abrupt("return","");case 13:case"end":return e.stop()}},e)})),function(e){return o.apply(this,arguments)}),h=function(e,n,t){var o=e.search?"&":"?";return e.pathname+e.search+(o+(t?d:s)+n)},b=function(e,n){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3?arguments[3]:void 0;if(v(e)){var a=t?"mweb":"web";if(!n)return void(0,i.nP)("".concat(a,".").concat(u,".social_tracking_pin_non_invite.insert.no_encrypted_id"));(0,i.nP)("".concat(a,".").concat(u,".social_tracking_pin_non_invite.insert.attempt"));try{var r=h(e,n,t||!1);(0,i.nP)("".concat(a,".").concat(u,".social_tracking_pin_non_invite.insert.success")),o(r)}catch(e){(0,i.nP)("".concat(a,".").concat(u,".social_tracking_pin_non_invite.insert.caught_exception"))}}},f=function(e,n){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3?arguments[3]:void 0;_?b(e,_,t,o):l(regeneratorRuntime.mark(function a(){var i;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,g(n);case 2:_=i=a.sent,b(e,i,t,o);case 5:case"end":return a.stop()}},a)}))()},S=function(e,n,t,o,a){var r,l=t?"mweb":"web";(0,i.nP)("".concat(l,".").concat(u,".social_tracking_pin_non_invite.attempt"));try{!t&&o&&v(e)?((0,i.nP)("".concat(l,".").concat(u,".social_tracking_pin_non_invite.search_string_eligible")),f(e,n,t,a)):(r=e.search,!m(r)&&!r.includes("sender")&&r.includes(u)&&(0,i.nP)("".concat(l,".").concat(u,".social_tracking_pin_non_invite.search_string_land")))}catch(e){(0,i.nP)("".concat(l,".").concat(u,".social_tracking_pin_non_invite.caught_exception"))}}},456871:function(e,n,t){t.d(n,{Z:function(){return c}});var o=t(653551),a=t(331357),i=t(173874),r=t(774838),l=t(843716),u=t(900907),s=t(986523),d=t(767415);function c(){var e,n=(0,r.B)(),t=n.isBot,c=n.isSocialBot,p=n.referrerFromCookie,_=n.referrerFromHeader,m=n.countryFromHostName,v=n.countryFromIp,g=n.regionFromIp,h=n.isAuthenticated,b=(0,o.TH)(),f=(0,s.Z)(),S=new URLSearchParams(b.search),w=!t&&!!S.get("utm_pai"),y=S.get("utm_source"),O=!t&&!c&&(0,i.hasInviteCode)(b),P=(0,u.Z)({countryFromHostName:m||"",countryFromIp:v||"",regionFromIp:g||"",isAuthenticated:h}),C=_||P&&p||"";e=f||!P?C:(0,l.an)(C);var E=!1,I=!t&&!c&&y&&["email",String(31)].includes(y),L=!t&&!c&&y&&["fb"].includes(y),U="offsite"===y,k=!t&&!c&&!!(e&&(/facebook/.test(e)||/fb/.test(e))),x=!t&&!c&&!!(e&&(/twitter/.test(e)||/tw/.test(e)));O&&(0,d.nP)("unauth.entry_channel.invite_code",{sampleRate:1}),I&&(0,d.nP)("unauth.entry_channel.email_utm_source",{sampleRate:1}),L&&(0,d.nP)("unauth.entry_channel.social_media_utm_source_fb",{sampleRate:1}),U&&(0,d.nP)("unauth.entry_channel.offsite_utm_source",{sampleRate:1}),k&&(0,d.nP)("unauth.entry_channel.social_media_referer_fb",{sampleRate:1}),x&&(0,d.nP)("unauth.entry_channel.social_media_referer_twitter",{sampleRate:1}),E=(0,l.Xn)(e);var N=!t&&E,T=!!S.get(a.J),M=!!S.get("twa_type")||e&&e.startsWith("android-app://com.pinterest.twa"),D=["utm_source","utm_medium","utm_campaign","utm_term","utm_content","utm_admin","utm_id","utm_mail","utm_swu"].some(function(e){return null!==S.get(e)})||!!e||T||M;return{isPaid:w,isInvite:O,utmSource:y,referrer:e,isSocial:O,isDirect:!t&&!w&&!O&&!N&&!D,isSEO:N,isBrowserStorageAllowed:P,isOffsite:U,isBot:t||c}}},843716:function(e,n,t){t.d(n,{Xn:function(){return v},Yf:function(){return S},an:function(){return g}});var o=t(173874),a=t(138482),i=t(575820),r="BING",l="GOOGLE",u="YAHOO",s="YANDEX",d="RAKUTEN",c="NAVER",p="AMP_CACHE",_="DUCKDUCKGO",m=[l,r,u,s,d,c,p,_];function v(e){return m.includes(function(e){var n=(0,i.Qc)(e,!0).hostname;if(n&&e){if(n.includes("google.")||e.includes("android-app://com.google.android.googlequicksearchbox"))return l;else if(n.includes("bing."))return r;else if(n.includes("yahoo."))return u;else if(n.includes("yandex."))return s;else if(n.includes("rakuten."))return d;else if(n.includes("naver."))return c;else if(n.includes("duckduckgo."))return _;else if(n.includes(".cdn.ampproject.org"))return p}return""}(e))}function g(e){return e||"undefined"!=typeof document&&document.referrer||""}var h=function(e){return"/"!==e[e.length-1]?"".concat(e,"/"):e},b=function(e){var n=h(e),t=(0,o.createRouterLocation)({url:n});return(0,o.isCloseupPage)(t)?"PIN":(0,o.isBoardPage)(t)?"BOARD":(0,a.Z)(t)?"PROFILE":(0,o.isAnyTodayPage)(t)?"TODAY":(0,o.isAnyIdeasPage)(t)?"IDEA":(0,o.isAnyShoppingPage)(t)?"SHOPPING":"UNKNOWN"},f=function(e){var n=e.selector,t=e.skipExternal,o=Array.from(document.querySelectorAll(n)),a={pin:[],board:[],user:[],today:[],idea:[],shopping:[]},i=new Set;return o.forEach(function(e){var n=e.getAttribute("href");if(!(!n||n.startsWith("#")||t&&n.startsWith("http")&&!n.includes(window.location.hostname))){var o=h(n);if(!i.has(o)){i.add(o);var r=b(o);"PIN"===r?a.pin.push(o):"BOARD"===r?a.board.push(o):"PROFILE"===r?a.user.push(o):"TODAY"===r?a.today.push(o):"IDEA"===r?a.idea.push(o):"SHOPPING"===r&&a.shopping.push(o)}}}),a},S=function(e){var n=e.country,t=e.language,o=e.isBot,a=e.hostname,i=e.pathname;return{domain:a,country:n,language:t,currentUrl:i,pageType:b(i),referrer:document.referrer,isBot:o,links:f({selector:"a[href]",skipExternal:!0})}}},434291:function(e,n,t){t.d(n,{m:function(){return r},r:function(){return l}});var o=t(815271);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,o)}return t}function r(e,n){(0,o.Z)("\uD83C\uDFAF ENGAGEMENT_SCORE_CALCULATED",function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach(function(n){var o,i;o=n,i=t[n],(o=function(e){var n=function(e,n){if("object"!=a(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var o=t.call(e,n||"default");if("object"!=a(o))return o;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==a(n)?n:n+""}(o))in e?Object.defineProperty(e,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[o]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}({trigger:e},n))}function l(e,n){(0,o.Z)("desktop"===e?"DESKTOP_UPSELL_DECISION":"MOBILE_UPSELL_DECISION",n)}},116412:function(e,n,t){t.d(n,{U:function(){return a},a:function(){return i}});var o=t(935833);function a(e){var n=e.PES,t=e.NUS,a=e.conversionIntentLevel,i=e.triggerAction,r=e.deviceType;(0,o.My)("engagement_score.calculated",{engagement_score:n,upsell_negative_score:t,user_intent_bucket:a,upsell_type_tag:"conversion",trigger_action:i,device_type:r})}function i(e){var n=e.upsellType,t=e.decision,a=e.intentLevel,i=e.PES,r=e.NUS,l=e.experimentVariant;(0,o.My)("upsell.decision_with_intent",{upsell_type:n,decision:t,intent_level:a,pes:i,nus:r,experiment_variant:l})}},184285:function(e,n,t){t.d(n,{HZ:function(){return b},ZP:function(){return x},e_:function(){return U},pT:function(){return O}});var o=t(387784),a=t(581722),i=t(653551),r=t(15881),l=t(95664),u=t(79271),s=t(456871),d=t(774838),c=t(418282),p=t(270922),_=t(739405),m=t(658375),v=t(767415),g=Date.now(),h=function(){return(0,a.v9)(function(e){var n,t;return null!=(n=null==(t=e.upsell)?void 0:t.mWebSignupModal.modal.isShown)&&n})},b=function(){return(0,a.v9)(function(e){var n;return null==(n=e.upsell)?void 0:n.modal})},f=function(){return(0,u.OC)()},S=function(){return Date.now()-g},w=function(){return(0,a.v9)(function(e){var n,t;return null!=(n=null==(t=e.upsell)?void 0:t.mWebSignupModal.isUnauthSharingModalsShown)&&n})},y=function(){return(0,a.v9)(function(e){var n;return!!(null!=(n=e.upsell)&&n.mWebSignupModal.modalHasShown)})},O=function(){return(0,a.v9)(function(e){var n;return null==(n=e.upsell)?void 0:n.mWebSignupModal})},P=function(){var e=(0,d.B)(),n=(0,s.Z)(),t=(0,_.ZP)(),a=(0,i.TH)();return(0,o.useMemo)(function(){return(0,p.T9)(e,n,t,a.pathname)},[e,n,t,a.pathname])},C=Object.freeze(["CO","ID"]),E=function(e){return C.includes(e)},I=function(e){if(!(0,l.ry)(e))return!1;var n=(0,c.Nl)();return n.getItem(r.QV)||((0,v.nP)("mobile_signup_modal.rules.suppress_for_social_in_app_browser"),n.setItem(r.QV,"1")),!0},L=function(e){var n=e.isUnauthSharingModalsShown,t=e.modalHasShown,o=e.sessionContext;if(!o)return!1;var a=o.country,i=o.userAgent;return n||t&&E(a)||(0,m.P)()||I(i)},U=function(e){var n=e.isModalShown,t=e.isUnauthSharingModalsShown,o=e.modalHasShown,a=e.country,i=e.userAgent;return!n&&!(t||o&&E(a)||(0,m.P)()||I(i))},k=function(){var e=h(),n=w(),t=y(),a=P();return(0,o.useCallback)(function(){return!e&&!L({isUnauthSharingModalsShown:n,modalHasShown:t,sessionContext:a})},[e,n,t,a])};function x(){return{isModalShown:h(),modal:(0,a.v9)(function(e){var n;return null==(n=e.upsell)?void 0:n.mWebSignupModal.modal}),upsellEligibleNavigationCount:(0,a.v9)(function(e){var n;return null==(n=e.upsell)?void 0:n.mWebSignupModal.upsellEligibleNavigationCount}),isUnauthSharingModalsShown:w(),modalHasShown:y(),sessionContext:P(),isUpsellEnabledGlobally:k(),getPinImpressionCount:f,getSessionDuration:S}}},432414:function(e,n,t){t.d(n,{ZW:function(){return k},Gk:function(){return U},YM:function(){return x}});var o=t(173874),a=t(138482),i=t(434291),r=t(116412),l=t(730056);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var s="dweb_eoq_q3_standard",d="dweb_eoq_q3_advanced",c="mweb_eoq_q3_standard",p="mweb_eoq_q3_advanced",_="mweb_eoq_q4_advanced_ucan",m="mweb_eoq_q4_emergency_ucan",v="mweb_eoq_q4_advanced_non_ucan",g="mweb_eoq_q4_emergency_non_ucan",h="dweb_eoq_q4_advanced_ucan",b="dweb_eoq_q4_emergency_ucan",f="dweb_eoq_q4_advanced_non_ucan",S="dweb_eoq_q4_emergency_non_ucan",w=[{bundleId:"dweb_eoq_q3_standard",experimentKey:s,active:!0,overrides:{desktop_navigational_modal_trigger:{evaluateContextOverride:{direct:{navigationalPagesViewThresholdDesktop:0},paid:{navigationalPagesViewThresholdDesktop:0},seo:{navigationalPagesViewThresholdDesktop:2}},stateOverride:{modal:{displayProps:{isWashBlocking:!0,signupFlow:{type:"login"}}}}}}},{bundleId:"dweb_eoq_q3_advanced",experimentKey:d,active:!0,overrides:{desktop_navigational_modal_trigger:{evaluateContextOverride:{direct:{navigationalPagesViewThresholdDesktop:0},paid:{navigationalPagesViewThresholdDesktop:0},seo:{navigationalPagesViewThresholdDesktop:2}},stateOverride:{modal:{displayProps:{isWashBlocking:!0,signupFlow:{type:"login"}}}}},desktop_context_menu_download_button_trigger:{evaluateContextOverride:{default:{limitReached:!0}},stateOverride:{modal:{displayProps:{signupFlow:{type:"login"}}}}},closeup_download_button_trigger:{evaluateContextOverride:{default:{limitReached:!0}},stateOverride:{modal:{displayProps:{signupFlow:{type:"login"},container:"lopDownloadUpsell",source:"lopDownloadUpsell"}}}}}},{bundleId:"mweb_eoq_q3_standard",experimentKey:c,active:!0,overrides:{mobile_on_land_upsell:{evaluateContextOverride:{direct:{shouldTriggerOnLand:!0},paid:{shouldTriggerOnLand:!0}},stateOverride:{mWebSignupModal:{modal:{displayProps:{allowCloseOnOutsideClick:!1}}}}},mobile_navigation_upsell:{evaluateContextOverride:{default:{navigationalPagesViewThresholdMobile:1}},stateOverride:{mWebSignupModal:{modal:{displayProps:{allowCloseOnOutsideClick:!1}}}}},mobile_main_pin_image_modal:{evaluateContextOverride:{default:{forceShowModal:!0}}},mobile_unauth_save_quota_check:{evaluateContextOverride:{default:{mobileUnauthSaveThreshold:0}},stateOverride:{mWebSignupModal:{modal:{displayProps:{headingType:"none"}}}}}}},{bundleId:"mweb_eoq_q3_advanced",experimentKey:p,active:!0,overrides:{mobile_on_land_upsell:{evaluateContextOverride:{direct:{shouldTriggerOnLand:!0},paid:{shouldTriggerOnLand:!0}},stateOverride:{mWebSignupModal:{modal:{displayProps:{allowCloseOnOutsideClick:!1}}}}},mobile_navigation_upsell:{evaluateContextOverride:{default:{navigationalPagesViewThresholdMobile:1}},stateOverride:{mWebSignupModal:{modal:{displayProps:{allowCloseOnOutsideClick:!1}}}}},mobile_main_pin_image_modal:{evaluateContextOverride:{default:{forceShowModal:!0}}},mobile_unauth_save_quota_check:{evaluateContextOverride:{default:{mobileUnauthSaveThreshold:0}},stateOverride:{mWebSignupModal:{modal:{displayProps:{headingType:"none"}}}}},mobile_context_menu_download_button_trigger:{evaluateContextOverride:{default:{limitReached:!0}}}}},{bundleId:"mweb_eoq_q4_advanced_ucan",experimentKey:_,active:!0,overrides:{mobile_on_land_upsell:{evaluateContextOverride:{direct:{shouldTriggerOnLand:!0},paid:{shouldTriggerOnLand:!0}},stateOverride:{mWebSignupModal:{modal:{displayProps:{allowCloseOnOutsideClick:!1}}}}},mobile_navigation_upsell:{evaluateContextOverride:{default:{navigationalPagesViewThresholdMobile:1}},stateOverride:{mWebSignupModal:{modal:{displayProps:{allowCloseOnOutsideClick:!1}}}}},mobile_main_pin_image_modal:{evaluateContextOverride:{default:{forceShowModal:!0}}},mobile_unauth_save_quota_check:{evaluateContextOverride:{default:{mobileUnauthSaveThreshold:0}},stateOverride:{mWebSignupModal:{modal:{displayProps:{headingType:"none"}}}}},mobile_context_menu_download_button_trigger:{evaluateContextOverride:{default:{limitReached:!0}}}}},{bundleId:"mweb_eoq_q4_emergency_ucan",experimentKey:m,active:!0,overrides:{mobile_on_land_upsell:{evaluateContextOverride:{direct:{shouldTriggerOnLand:!0},paid:{shouldTriggerOnLand:!0},seo:{shouldTriggerOnLand:!0}},stateOverride:{mWebSignupModal:{modal:{displayProps:{allowCloseOnOutsideClick:!1}}}}},mobile_navigation_upsell:{evaluateContextOverride:{default:{navigationalPagesViewThresholdMobile:1}},stateOverride:{mWebSignupModal:{modal:{displayProps:{allowCloseOnOutsideClick:!1}}}}},mobile_main_pin_image_modal:{evaluateContextOverride:{default:{forceShowModal:!0}}},mobile_unauth_save_quota_check:{evaluateContextOverride:{default:{mobileUnauthSaveThreshold:0}},stateOverride:{mWebSignupModal:{modal:{displayProps:{headingType:"none"}}}}},mobile_context_menu_download_button_trigger:{evaluateContextOverride:{default:{limitReached:!0}}}}},{bundleId:"mweb_eoq_q4_advanced_non_ucan",experimentKey:v,active:!0,overrides:{mobile_on_land_upsell:{evaluateContextOverride:{direct:{shouldTriggerOnLand:!0},paid:{shouldTriggerOnLand:!0}},stateOverride:{mWebSignupModal:{modal:{displayProps:{allowCloseOnOutsideClick:!1}}}}},mobile_navigation_upsell:{evaluateContextOverride:{default:{navigationalPagesViewThresholdMobile:1}},stateOverride:{mWebSignupModal:{modal:{displayProps:{allowCloseOnOutsideClick:!1}}}}},mobile_main_pin_image_modal:{evaluateContextOverride:{default:{forceShowModal:!0}}},mobile_unauth_save_quota_check:{evaluateContextOverride:{default:{mobileUnauthSaveThreshold:0}},stateOverride:{mWebSignupModal:{modal:{displayProps:{headingType:"none"}}}}},mobile_context_menu_download_button_trigger:{evaluateContextOverride:{default:{limitReached:!0}}}}},{bundleId:"mweb_eoq_q4_emergency_non_ucan",experimentKey:g,active:!0,overrides:{mobile_on_land_upsell:{evaluateContextOverride:{direct:{shouldTriggerOnLand:!0},paid:{shouldTriggerOnLand:!0},seo:{shouldTriggerOnLand:!0}},stateOverride:{mWebSignupModal:{modal:{displayProps:{allowCloseOnOutsideClick:!1}}}}},mobile_navigation_upsell:{evaluateContextOverride:{default:{navigationalPagesViewThresholdMobile:1}},stateOverride:{mWebSignupModal:{modal:{displayProps:{allowCloseOnOutsideClick:!1}}}}},mobile_main_pin_image_modal:{evaluateContextOverride:{default:{forceShowModal:!0}}},mobile_unauth_save_quota_check:{evaluateContextOverride:{default:{mobileUnauthSaveThreshold:0}},stateOverride:{mWebSignupModal:{modal:{displayProps:{headingType:"none"}}}}},mobile_context_menu_download_button_trigger:{evaluateContextOverride:{default:{limitReached:!0}}}}},{bundleId:"dweb_eoq_q4_advanced_ucan",experimentKey:h,active:!0,overrides:{desktop_navigational_modal_trigger:{evaluateContextOverride:{direct:{navigationalPagesViewThresholdDesktop:0},paid:{navigationalPagesViewThresholdDesktop:0},seo:{navigationalPagesViewThresholdDesktop:2}},stateOverride:{modal:{displayProps:{isWashBlocking:!0,signupFlow:{type:"login"}}}}},desktop_context_menu_download_button_trigger:{evaluateContextOverride:{default:{limitReached:!0}},stateOverride:{modal:{displayProps:{signupFlow:{type:"login"}}}}},closeup_download_button_trigger:{evaluateContextOverride:{default:{limitReached:!0}},stateOverride:{modal:{displayProps:{signupFlow:{type:"login"},container:"lopDownloadUpsell",source:"lopDownloadUpsell"}}}}}},{bundleId:"dweb_eoq_q4_advanced_non_ucan",experimentKey:f,active:!0,overrides:{desktop_navigational_modal_trigger:{evaluateContextOverride:{direct:{navigationalPagesViewThresholdDesktop:0},paid:{navigationalPagesViewThresholdDesktop:0},seo:{navigationalPagesViewThresholdDesktop:2}},stateOverride:{modal:{displayProps:{isWashBlocking:!0,signupFlow:{type:"login"}}}}},desktop_context_menu_download_button_trigger:{evaluateContextOverride:{default:{limitReached:!0}},stateOverride:{modal:{displayProps:{signupFlow:{type:"login"}}}}},closeup_download_button_trigger:{evaluateContextOverride:{default:{limitReached:!0}},stateOverride:{modal:{displayProps:{signupFlow:{type:"login"},container:"lopDownloadUpsell",source:"lopDownloadUpsell"}}}}}},{bundleId:"dweb_eoq_q4_emergency_ucan",experimentKey:b,active:!0,overrides:{desktop_navigational_modal_trigger:{evaluateContextOverride:{direct:{navigationalPagesViewThresholdDesktop:0},paid:{navigationalPagesViewThresholdDesktop:0},seo:{navigationalPagesViewThresholdDesktop:0}},stateOverride:{modal:{displayProps:{isWashBlocking:!0,signupFlow:{type:"login"}}}}},desktop_context_menu_download_button_trigger:{evaluateContextOverride:{default:{limitReached:!0}},stateOverride:{modal:{displayProps:{signupFlow:{type:"login"}}}}},closeup_download_button_trigger:{evaluateContextOverride:{default:{limitReached:!0}},stateOverride:{modal:{displayProps:{signupFlow:{type:"login"},container:"lopDownloadUpsell",source:"lopDownloadUpsell"}}}}}},{bundleId:"dweb_eoq_q4_emergency_non_ucan",experimentKey:S,active:!0,overrides:{desktop_navigational_modal_trigger:{evaluateContextOverride:{direct:{navigationalPagesViewThresholdDesktop:0},paid:{navigationalPagesViewThresholdDesktop:0},seo:{navigationalPagesViewThresholdDesktop:0}},stateOverride:{modal:{displayProps:{isWashBlocking:!0,signupFlow:{type:"login"}}}}},desktop_context_menu_download_button_trigger:{evaluateContextOverride:{default:{limitReached:!0}},stateOverride:{modal:{displayProps:{signupFlow:{type:"login"}}}}},closeup_download_button_trigger:{evaluateContextOverride:{default:{limitReached:!0}},stateOverride:{modal:{displayProps:{signupFlow:{type:"login"},container:"lopDownloadUpsell",source:"lopDownloadUpsell"}}}}}}];function y(e,n){var t,o=w.filter(function(t){if(!t.active||!t.overrides[e])return!1;switch(t.experimentKey){case s:return n("dweb_eoq_q3_standard").anyEnabled;case d:return n("dweb_eoq_q3_advanced").anyEnabled;case c:return n("mweb_eoq_q3_standard").anyEnabled;case p:return n("mweb_eoq_q3_advanced").anyEnabled;case _:return n("mweb_eoq_q4_advanced_ucan").anyEnabled;case m:return n("mweb_eoq_q4_emergency_ucan").anyEnabled;case v:return n("mweb_eoq_q4_advanced_non_ucan").anyEnabled;case g:return n("mweb_eoq_q4_emergency_non_ucan").anyEnabled;case h:return n("dweb_eoq_q4_advanced_ucan").anyEnabled;case b:return n("dweb_eoq_q4_emergency_ucan").anyEnabled;case f:return n("dweb_eoq_q4_advanced_non_ucan").anyEnabled;case S:return n("dweb_eoq_q4_emergency_non_ucan").anyEnabled;default:return!1}});return null==(t=o[o.length-1])?void 0:t.overrides[e]}var O=function(e){var n,t,o,a,i,r;return{id:e.id,evaluate:(t=(n={ruleId:e.id,baseEvaluateFunction:e.evaluate}).ruleId,o=n.baseEvaluateFunction,function(e){var n,a,i=e.checkExperiment,r=e.session,u=i&&(null==(n=y(t,i))?void 0:n.evaluateContextOverride)||{},s=u[null!=(a=null==r?void 0:r.channel)?a:"default"]||u.default||{};return o((0,l.Z)(e,s))}),getNextState:(i=(a={ruleId:e.id,baseNextStateFunction:e.getNextState}).ruleId,r=a.baseNextStateFunction,function(e){var n,t=e.action,o=r({action:t,state:e.state,decision:e.decision});if(!("payload"in t&&"object"===u(t.payload)&&null!==t.payload&&"checkExperiment"in t.payload))return o;var a=(null==(n=y(i,t.payload.checkExperiment))?void 0:n.stateOverride)||{};return 0===Object.keys(a).length?o:(0,l.Z)(o,a)})}},P=t(671220);function C(e){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function E(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,o)}return t}function I(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?E(Object(t),!0).forEach(function(n){var o,a;o=n,a=t[n],(o=function(e){var n=function(e,n){if("object"!=C(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var o=t.call(e,n||"default");if("object"!=C(o))return o;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==C(n)?n:n+""}(o))in e?Object.defineProperty(e,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[o]=a}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):E(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var L=function(e,n){var t={enabled_1:["high","medium"],enabled_2:["high"],enabled_3:["medium"],enabled_4:["medium","low"]}[n];return!!t&&t.includes(e||"unknown")},U={shouldShowRelatedPinsGradientUpsell:O({id:"desktop_related_pins_gradient_upsell_trigger",evaluate:function(e){var n=e.relatedPinsGradientUpsellEverShown,t=e.checkExperiment;if(n)return!1;var o=null==t?void 0:t("ce_dweb_unauth_related_pins_limit");return!!(null!=o&&o.anyEnabled)},getNextState:function(e){return I(I({},e.state),{},{showRelatedPinsGradientUpsell:!0,relatedPinsGradientUpsellEverShown:!0})}}),shouldShowCloseupNavigationalModal:O({id:"closeup_navigational_modal_trigger",evaluate:function(e){var n=e.pinViewCount,t=e.navigationalPagesUpsellSeen,o=e.checkExperiment;return(null==o||!o("pc_no_navigational_upsell").anyEnabled)&&(null!=n?n:0)>=4&&!t},getNextState:function(e){return I(I({},e.state),{},{modal:{isShown:!0,displayProps:{signupFlow:{type:"login"},attributionLabel:"navigation_1",container:"closeup",reason:"UPSELL_LOGIN_OR_SIGNUP"}},navigationalPagesUpsellSeen:!0})}}),shouldShowSaveModal:O({id:"save_modal_trigger",evaluate:function(){return!0},getNextState:function(e){var n=e.action,t=e.state;return I(I({},t),{},{pinSaveCount:t.pinSaveCount+1,pinId:n.payload.pinId,attributionLabel:n.payload.attributionLabel,showSaveModal:!0,modal:{isShown:!0,displayProps:{attributionLabel:n.payload.attributionLabel,container:"save",reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP",savePinId:n.payload.pinId,signupFlow:{type:"signup"},source:"saveButtonExp"}}})}}),shouldShowNavigationalModal:O({id:"desktop_navigational_modal_trigger",evaluate:function(e){var n=e.uniqueNavigationalPagesSeen,t=e.navigationalPagesUpsellSeen,o=e.navigationalPagesViewThresholdDesktop,a=e.checkExperiment;return(null==a||!a("pc_no_navigational_upsell").anyEnabled)&&(void 0===n?[]:n).length>=(null!=o?o:4)&&!t},getNextState:function(e){var n=e.state,t=e.action;return I(I({},n),{},{modal:{isShown:!0,displayProps:{signupFlow:{type:"login"},attributionLabel:"navigation_".concat(t.payload.containerPage),container:t.payload.containerPage,reason:"UPSELL_LOGIN_OR_SIGNUP"}},navigationalPagesUpsellSeen:!0})}}),shouldShowNavigationalModalIntentBased:O({id:"desktop_navigational_modal_intent_trigger",evaluate:function(e){var n=e.navigationalPagesUpsellSeen,t=e.engagementScore,o=e.checkExperiment,a=null==o?void 0:o("engagement_score_v0_dweb");if(!(null!=a&&a.anyEnabled)||n)return!1;var l=t||{},u=l.conversionIntentLevel,s=l.PES,d=l.NUS,c=L(u,a.group);return(0,i.r)("desktop",{variant:a.group,decision:c?"SHOW":"SKIP",intentLevel:u,PES:s||0,NUS:d||0,reason:c?"Intent ".concat(u," in allowed list"):"Intent ".concat(u," NOT in allowed list")}),(0,r.a)({upsellType:"navigation_desktop",decision:c?"show":"skip",intentLevel:u||"unknown",PES:s||0,NUS:d||0,experimentVariant:a.group}),c},getNextState:function(e){var n=e.state,t=e.action,o=n.engagementScore||{},a=o.conversionIntentLevel,i=o.PES,r=o.NUS;return I(I({},n),{},{modal:{isShown:!0,displayProps:{signupFlow:{type:"login"},attributionLabel:"navigation_intent_".concat(a,"_pes_").concat(i||0,"_nus_").concat(r||0),container:t.payload.containerPage,reason:"UPSELL_LOGIN_OR_SIGNUP"}},navigationalPagesUpsellSeen:!0})}}),shouldShowSignupModalOnCloseUpClick:O({id:"closeup_modal_trigger",evaluate:function(e){var n=e.modal,t=e.clickCloseUp;return!(null!=n&&n.isShown)&&!t},getNextState:function(e){return I(I({},e.state),{},{modal:{isShown:!0,displayProps:{signupFlow:{type:"signup"},attributionLabel:"click_closeup",container:"pinWash",reason:"UPSELL_LOGIN_OR_SIGNUP"}},clickCloseUp:!0})}}),shouldShowSignupModalOnClickContextMenuSaveButton:O({id:"context_menu_save_button_trigger",evaluate:function(e){var n=e.modal,t=e.clickContextMenuSaveButton;return!(null!=n&&n.isShown)&&!t},getNextState:function(e){var n,t,o=e.action,a=e.state;return t=["enabled_all_improved","enabled_all","enabled_save"].includes(o.payload.signupToLoginExpGroup)?{signupFlow:{type:"login"},attributionLabel:"click_context_menu_".concat(o.payload.attributionLabelSource,"_save_button"),container:"save",reason:"UPSELL_LOGIN_OR_SIGNUP",source:"enabled_all_improved"===o.payload.signupToLoginExpGroup?"saveButton":"defaultSource"}:{signupFlow:{type:"signup"},attributionLabel:"click_context_menu_".concat(o.payload.attributionLabelSource,"_save_button"),container:"save",reason:"UPSELL_LOGIN_OR_SIGNUP",source:"saveButtonExp",savePinId:o.payload.pinId},I(I({},a),{},{modal:{isShown:!0,displayProps:t},clickContextMenuSaveButton:!0,pinId:null!=(n=o.payload.pinId)?n:"",attributionLabel:o.payload.attributionLabelSource})}}),shouldShowSignupModalOnClickCloseupSaveButton:O({id:"closeup_save_button_trigger",evaluate:function(e){var n=e.modal,t=e.clickCloseUpContextMenuSaveButton;return!(null!=n&&n.isShown)&&!t},getNextState:function(e){var n,t,o=e.action,a=e.state;return t=["enabled_all_improved","enabled_all","enabled_save"].includes(o.payload.signupToLoginExpGroup)?{signupFlow:{type:"login"},attributionLabel:"click_context_menu_".concat(o.payload.attributionLabelSource,"_save_button"),container:"save",reason:"UPSELL_LOGIN_OR_SIGNUP",source:"enabled_all_improved"===o.payload.signupToLoginExpGroup?"saveButton":"defaultSource"}:{signupFlow:{type:"signup"},attributionLabel:"click_context_menu_".concat(o.payload.attributionLabelSource,"_save_button"),container:"save",reason:"UPSELL_LOGIN_OR_SIGNUP",source:"saveButtonExp",savePinId:o.payload.pinId},I(I({},a),{},{modal:{isShown:!0,displayProps:t},clickCloseUpContextMenuSaveButton:!0,pinId:null!=(n=o.payload.pinId)?n:"",attributionLabel:o.payload.attributionLabelSource})}}),shouldShowSignupModalOnContextMenuDownloadClick:O({id:"desktop_context_menu_download_button_trigger",evaluate:function(e){var n=e.limitReached,t=e.inImmediateUpsellGroup,o=e.modal;return!!((n||t)&&!(null!=o&&o.isShown))},getNextState:function(e){var n,t,o=e.action,a=e.state;return t=o.payload.inDwebSwapDownloadUpsellExp?{signupFlow:{type:"login"},attributionLabel:"click_".concat(o.payload.attributionLabelSource,"_download_button"),container:"lopDownloadUpsell",reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP",source:"lopDownloadUpsell"}:{signupFlow:{type:"signup"},attributionLabel:"click_".concat(o.payload.attributionLabelSource,"_download_button"),container:"download",reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP",source:"downloadImageBtnUnauth",savePinId:o.payload.pinId},I(I({},a),{},{modal:{isShown:!0,displayProps:t},clickContextMenuDownloadButton:!0,pinId:null!=(n=o.payload.pinId)?n:"",attributionLabel:o.payload.attributionLabelSource})}}),shouldShowSignupModalOnCloseupDownloadClick:O({id:"closeup_download_button_trigger",evaluate:function(e){var n=e.limitReached,t=e.modal;return!!(n&&!(null!=t&&t.isShown))},getNextState:function(e){var n,t=e.action;return I(I({},e.state),{},{modal:{isShown:!0,displayProps:{signupFlow:{type:"signup"},attributionLabel:"click_context_menu_".concat(t.payload.attributionLabelSource,"_download_button"),container:"download",reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP",source:"downloadImageBtnUnauth",savePinId:t.payload.pinId}},clickCloseUpContextMenuDownloadButton:!0,pinId:null!=(n=t.payload.pinId)?n:"",attributionLabel:t.payload.attributionLabelSource})}}),shouldShowSignupModalOnFollowButtonClick:O({id:"follow_button_trigger",evaluate:function(e){var n=e.modal,t=e.clickFollowButton;return!(null!=n&&n.isShown)&&!t},getNextState:function(e){var n=e.action;return I(I({},e.state),{},{modal:{isShown:!0,displayProps:{signupFlow:{type:"signup"},attributionLabel:n.payload.isIdeaPin?"click_idea_pin_follow":"click_follow",container:n.payload.isContextualFollowEnabled?"follow":"",reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP",source:n.payload.isContextualFollowEnabled?"followButton":void 0}},clickFollowButton:!0})}}),shouldShowSignupModalOnFollowingButtonClick:O({id:"following_button_trigger",evaluate:function(e){var n=e.modal,t=e.clickFollowingButton;return!(null!=n&&n.isShown)&&!t},getNextState:function(e){return I(I({},e.state),{},{modal:{isShown:!0,displayProps:{signupFlow:{type:"signup"},attributionLabel:"click_following",reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP"}},clickFollowingButton:!0})}}),shouldShowSignupModalOnFollowersButtonClick:O({id:"followers_button_trigger",evaluate:function(e){var n=e.modal,t=e.clickFollowersButton;return!(null!=n&&n.isShown)&&!t},getNextState:function(e){return I(I({},e.state),{},{modal:{isShown:!0,displayProps:{signupFlow:{type:"signup"},attributionLabel:"click_followers",reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP"}},clickFollowersButton:!0})}}),shouldShowLoginModalOnCommentComposerClick:O({id:"comment_composer_trigger",evaluate:function(e){var n=e.modal,t=e.clickCommentComposerUpsell;return!(null!=n&&n.isShown)&&!t},getNextState:function(e){return I(I({},e.state),{},{modal:{isShown:!0,displayProps:{signupFlow:{type:"login"},attributionLabel:"tap_unauth_comment_composer",container:"closeup",reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP",source:"commentComposer"}},clickCommentComposerUpsell:!0})}}),shouldShowLoginModalOnRelatedPinOpenLinkClick:O({id:"related_pin_open_link_trigger",evaluate:function(e){var n=e.modal,t=e.clickRelatedPinOpenLinkUpsell;return!(null!=n&&n.isShown)&&!t},getNextState:function(e){return I(I({},e.state),{},{modal:{isShown:!0,displayProps:{signupFlow:{type:"login"},attributionLabel:"click_context_menu_related_pin_right_click_open_link_button",reason:"UPSELL_LOGIN_OR_SIGNUP"}},clickRelatedPinOpenLinkUpsell:!0})}}),shouldShowLoginModalOnPinLinkClick:O({id:"pin_link_trigger",evaluate:function(e){var n=e.modal,t=e.pinLinkClickCount,o=void 0===t?0:t;return!(null!=n&&n.isShown)&&(2===o||o%5==0)},getNextState:function(e){var n=e.action;return I(I({},e.state),{},{modal:{isShown:!0,displayProps:{signupFlow:{type:"login"},attributionLabel:"pinLinkClickHandler_tier1",container:"hybrid_clickthrough",reason:"UPSELL_LOGIN_OR_SIGNUP"}},clickPinLinkCount:n.payload.count})}}),shouldShowSocialPinLandingModal:O({id:"social_pin_landing_modal_trigger",evaluate:function(e){var n=e.inviter,t=e.socialPinLandingModalShown,o=e.checkExperiment;if(!n||t)return!1;var a=null==o?void 0:o("ce_dweb_unauth_splp_blocking").anyEnabled,i=null==o?void 0:o("ce_dweb_unauth_splp_blocking_no_delay").anyEnabled,r=null==o?void 0:o("ce_dweb_unauth_splp_blocking_3s").anyEnabled;return!!(a||i||r)},getNextState:function(e){var n=e.action;return I(I({},e.state),{},{modal:{isShown:!0,displayProps:{signupFlow:{type:"signup"},attributionLabel:n.type===P.Fy?"delay_".concat(n.payload.containerPage):"scroll_".concat(n.payload.containerPage),container:n.payload.containerPage,reason:"UPSELL_LOGIN_OR_SIGNUP"}},socialPinLandingModalShown:!0})}}),shouldShowScrollingBox:{id:"desktop_scrolling_box_trigger",evaluate:function(e){var n=e.checkExperiment;return!(null==n?void 0:n("pc_no_navigational_upsell").anyEnabled)},getNextState:function(e){return e.state}}},k={shouldShowSaveEducationPopover:O({id:"mobile_save_education_popover_trigger",evaluate:function(e){var n=e.saveEducationPopoverEverShown,t=e.checkExperiment;if(n)return!1;var o=((null==t?void 0:t("ce_mweb_unauth_social_feature_education"))||{}).group;return!!(null==o?void 0:o.startsWith("enabled_group_board"))},getNextState:function(e){return I(I({},e.state),{},{showSaveEducationPopover:!0,saveEducationPopoverEverShown:!0})}}),shouldShowReplyToSenderSheet:O({id:"mobile_reply_to_sender_sheet_trigger",evaluate:function(e){var n=e.replyToSenderSheetEverShown,t=e.checkExperiment;if(n)return!1;var o=((null==t?void 0:t("ce_mweb_unauth_social_feature_education"))||{}).group;return!!(null==o?void 0:o.startsWith("enabled_reply_to_sender"))},getNextState:function(e){return I(I({},e.state),{},{showReplyToSenderSheet:!0,replyToSenderSheetEverShown:!0})}}),shouldAllowUnauthSave:O({id:"mobile_unauth_save_quota_check",evaluate:function(e){var n=e.isPPMAndroidUnauthExperience,t=e.isFromUnauthContextMenu,o=e.currentUnauthSaves,a=e.mobileUnauthSaveThreshold;return!t&&!n&&(void 0===o?0:o)<(null!=a?a:2)},getNextState:function(e){var n,t=e.action,o=e.state;return I(I({},o),{},{mWebSignupModal:I(I({},o.mWebSignupModal),{},{lastShownTime:Date.now(),timesShownForSessionCount:(null!=(n=o.mWebSignupModal.timesShownForSessionCount)?n:0)+1,scrollControllerHasDisplayed:o.mWebSignupModal.scrollControllerHasDisplayed,modal:{isShown:!0,displayProps:{headingType:t.payload.headingType,trigger:{attributionLabel:"extended_save_out_of_quota"===t.payload.headingType?"click_save_button_with_max_unauth_saves":t.payload.attributionLabel||"click_save_button_on_closeup",reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP"},allowCloseOnOutsideClick:!0},pinId:t.payload.pinId}})})}}),shouldShowMainPinImageNavigationalModal:O({id:"mobile_main_pin_image_modal",evaluate:function(e){var n=e.checkExperiment,t=e.isUpsellEnabledGlobally,o=e.isModalCurrentlyShown,a=e.learningUpsellScenario,i=e.forceShowModal,r=a&&t&&!o&&((null==n?void 0:n("mweb_unauth_main_learning_pin_full_page").anyEnabled)||(null==n?void 0:n("mweb_q2_mau_push_pc_advanced").anyEnabled)||(null==n?void 0:n("mweb_q2_mau_push_pc_advanced_row").anyEnabled)||(null==n?void 0:n("mweb_q2_mau_push_pc_emergency").anyEnabled)||(null==n?void 0:n("mweb_q2_mau_push_pc_emergency_row").anyEnabled)||(null==n?void 0:n("mweb_q2_mau_push_pc_eu_safe").anyEnabled));return a&&(i||!!r)},getNextState:function(e){var n,t,o=e.action,a=e.state;return I(I({},a),{},{mWebSignupModal:I(I({},a.mWebSignupModal),{},{lastShownTime:Date.now(),timesShownForSessionCount:(null!=(n=null==(t=a.mWebSignupModal)?void 0:t.timesShownForSessionCount)?n:0)+1,scrollControllerHasDisplayed:a.mWebSignupModal.scrollControllerHasDisplayed,modal:{isShown:!0,displayProps:{headingType:"none",trigger:{attributionLabel:"navigation_main_pin_image_click",reason:"UPSELL_LOGIN_OR_SIGNUP"},allowCloseOnOutsideClick:!0},pinId:o.payload.pinId}})})}}),shouldShowMainPinImageAppUpsell:{id:"mobile_main_pin_app_upsell_purple_banner",getNextState:function(e){return e.state},evaluate:function(e){var n=e.learningUpsellScenario,t=e.hasConversionUpsell,o=e.isLearningAppUpsellShown;return t||!n?{shouldToggleAppUpsell:!1,currentlyShowing:!1,newState:!1}:{shouldToggleAppUpsell:!0,currentlyShowing:o,newState:!o}}},shouldShowNavigationUpsell:O({id:"mobile_navigation_upsell",evaluate:function(e){var n,t=e.isUpsellEnabledGlobally,o=e.isModalCurrentlyShown,a=e.newLocation,i=e.isNavigationFromSwipe,r=e.currentNavigationCount,l=e.hasSeenModal,u=e.pageThreshold,s=e.isWashDismissible,d=e.canShowSignupModalOnRouteChange,c=e.navigationalPagesViewThresholdMobile,p=e.checkExperiment;if(null==p?void 0:p("pc_no_navigational_upsell").anyEnabled)return{shouldShowModal:!1,shouldDismissModal:!1,shouldIncrementCount:!1};var _=c||u||4;if(o)return{shouldShowModal:!1,shouldDismissModal:!0,shouldIncrementCount:!1};if(!(t&&!i)||!(a&&(null==d?void 0:d(a))))return{shouldShowModal:!1,shouldDismissModal:!1,shouldIncrementCount:!1};if(!((null!=r?r:0)>=_)||l)return{shouldShowModal:!1,shouldDismissModal:!1,shouldIncrementCount:!0};var m=null==p?void 0:p("mweb_feature_upsell_copy_visual_combination_v2"),v=null!=(n=null==m?void 0:m.anyEnabled)&&n;return{shouldShowModal:!0,shouldDismissModal:!1,shouldIncrementCount:!0,attributionLabel:"navigation_".concat(_,"_").concat(r),allowCloseOnOutsideClick:s,headingType:v?"mweb_feature_upsell_copy_visual_combination_v2":"none"}},getNextState:function(e){var n,t,o,a=e.state,i=e.decision;return I(I({},a),{},{mWebSignupModal:I(I({},a.mWebSignupModal),{},{lastShownTime:Date.now(),timesShownForSessionCount:(null!=(n=a.mWebSignupModal.timesShownForSessionCount)?n:0)+1,scrollControllerHasDisplayed:a.mWebSignupModal.scrollControllerHasDisplayed,modalHasShown:!0,modal:{isShown:!0,displayProps:{headingType:null!=(t=null==i?void 0:i.headingType)?t:"none",trigger:{attributionLabel:null!=(o=null==i?void 0:i.attributionLabel)?o:"",reason:"UPSELL_LOGIN_OR_SIGNUP"},allowCloseOnOutsideClick:!!(null!=i&&i.allowCloseOnOutsideClick)},pinId:null}})})}}),shouldShowNavigationUpsellIntentBased:O({id:"mobile_navigation_upsell_intent",evaluate:function(e){var n,t=e.isUpsellEnabledGlobally,o=e.isModalCurrentlyShown,a=e.newLocation,l=e.isNavigationFromSwipe,u=e.hasSeenModal,s=e.canShowSignupModalOnRouteChange,d=e.engagementScore,c=e.checkExperiment,p=null==c?void 0:c("engagement_score_v0_mweb");if(!(null!=p&&p.anyEnabled))return{shouldShowModal:!1,shouldDismissModal:!1,shouldIncrementCount:!1};if(o)return{shouldShowModal:!1,shouldDismissModal:!0,shouldIncrementCount:!1};if(!t||l||!a||!(null!=s&&s(a)))return{shouldShowModal:!1,shouldDismissModal:!1,shouldIncrementCount:!1};if(u)return{shouldShowModal:!1,shouldDismissModal:!1,shouldIncrementCount:!0};var _=d||{},m=_.conversionIntentLevel,v=_.PES,g=_.NUS,h=L(m,p.group);if((0,i.r)("mobile",{variant:p.group,decision:h?"SHOW":"SKIP",intentLevel:m,PES:v||0,NUS:g||0,reason:h?"Intent ".concat(m," in allowed list"):"Intent ".concat(m," NOT in allowed list")}),(0,r.a)({upsellType:"navigation_mobile",decision:h?"show":"skip",intentLevel:m||"unknown",PES:v||0,NUS:g||0,experimentVariant:p.group}),!h)return{shouldShowModal:!1,shouldDismissModal:!1,shouldIncrementCount:!0};var b=null==c?void 0:c("mweb_feature_upsell_copy_visual_combination_v2"),f=null!=(n=null==b?void 0:b.anyEnabled)&&n;return{shouldShowModal:!0,shouldDismissModal:!1,shouldIncrementCount:!0,attributionLabel:"navigation_intent_".concat(m,"_pes_").concat(v||0,"_nus_").concat(g||0),allowCloseOnOutsideClick:!0,headingType:f?"mweb_feature_upsell_copy_visual_combination_v2":"none"}},getNextState:function(e){var n,t,o,a=e.state,i=e.decision;return I(I({},a),{},{mWebSignupModal:I(I({},a.mWebSignupModal),{},{lastShownTime:Date.now(),timesShownForSessionCount:(null!=(n=a.mWebSignupModal.timesShownForSessionCount)?n:0)+1,scrollControllerHasDisplayed:a.mWebSignupModal.scrollControllerHasDisplayed,modalHasShown:!0,modal:{isShown:!0,displayProps:{headingType:null!=(t=null==i?void 0:i.headingType)?t:"none",trigger:{attributionLabel:null!=(o=null==i?void 0:i.attributionLabel)?o:"",reason:"UPSELL_LOGIN_OR_SIGNUP"},allowCloseOnOutsideClick:!!(null!=i&&i.allowCloseOnOutsideClick)},pinId:null}})})}}),shouldShowOnLandUpsell:O({id:"mobile_on_land_upsell",evaluate:function(e){var n,t,i=e.checkExperiment,r=e.isUpsellEnabledGlobally,l=e.hasSeenNavUpsell,u=e.location,s=e.userAgent,d=e.showUnauthMwebSocialDefaultModalUpsell,c=e.isSocialInAppBrowser,p=e.shouldTriggerOnLand;if((null==i?void 0:i("pc_no_navigational_upsell").anyEnabled)||!r||l||!(u&&((0,o.isCloseupPage)(u)||(0,o.isBoardPage)(u)||(0,a.Z)(u)||(0,o.isSearchPage)(u)||(0,o.hasInviteCode)(u))))return{shouldShowModal:!1,shouldIncrementCount:!1,modalConfig:null};var _=!((null==c?void 0:c(s))&&(null==i?void 0:i("mweb_unauth_social_iab_upsell_boost_experiment",{dangerouslySkipActivation:!0}).anyEnabled))&&d;if(!d&&!(void 0!==p&&p))return{shouldShowModal:!1,shouldIncrementCount:!1,modalConfig:null};var m=_?null:null==i?void 0:i("mweb_feature_upsell_copy_visual_combination_v2"),v=null!=(n=null==m?void 0:m.anyEnabled)&&n;if("social"==(t=_?"social":v?"mweb_feature_upsell_copy_visual_combination_v2":"none")&&i){var g=i("ce_mweb_visual_plp_upsell");if(g.anyEnabled)switch(g.group){case"enabled_1":t="social_visual_1";break;case"enabled_2":t="social_visual_2";break;case"enabled_3":t="social_visual_3"}}return{shouldShowModal:!0,shouldIncrementCount:!0,showUnauthMwebSocialUpsell:_,modalConfig:{reason:"UPSELL_LOGIN_OR_SIGNUP",attributionLabel:"navigation_0",navigationTriggeredUpsell:{newLocation:u,oldLocation:u},headingType:t}}},getNextState:function(e){var n,t,o=e.state,a=e.decision.modalConfig;return I(I({},o),{},{mWebSignupModal:I(I({},o.mWebSignupModal),{},{lastShownTime:Date.now(),timesShownForSessionCount:(null!=(n=o.mWebSignupModal.timesShownForSessionCount)?n:0)+1,scrollControllerHasDisplayed:o.mWebSignupModal.scrollControllerHasDisplayed,modalHasShown:!0,modal:{isShown:!0,displayProps:{headingType:null==a?void 0:a.headingType,trigger:{attributionLabel:null!=(t=null==a?void 0:a.attributionLabel)?t:"",reason:"UPSELL_LOGIN_OR_SIGNUP"},allowCloseOnOutsideClick:!0},pinId:null}})})}}),shouldShowSignupModalOnContextMenuDownloadClick:O({id:"mobile_context_menu_download_button_trigger",evaluate:function(e){var n=e.limitReached,t=e.inImmediateUpsellGroup,o=e.modal;return(n||t)&&!(null!=o&&o.isShown)},getNextState:function(e){var n,t=e.action,o=e.state,a=t.payload,i=a.inMwebDownloadCTAExp,r=a.showDownloadCloseupIcon,l=a.attributionLabelSource,u="none";u=i||r?"download_limit_reached":"none";var s={trigger:{attributionLabel:"click_".concat(l,"_download_button"),reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP"},headingType:u};return I(I({},o),{},{mWebSignupModal:I(I({},o.mWebSignupModal),{},{modal:{isShown:!0,displayProps:s,pinId:null!=(n=t.payload.pinId)?n:""}})})}}),shouldShowSignupModalOnFollowButtonClickMobile:O({id:"follow_button_trigger_mobile",evaluate:function(e){var n=e.mWebSignupModal;return!(null!=n&&n.modal.isShown)},getNextState:function(e){var n,t=e.action,o=e.state;return I(I({},o),{},{mWebSignupModal:I(I({},o.mWebSignupModal),{},{lastShownTime:Date.now(),timesShownForSessionCount:(null!=(n=o.mWebSignupModal.timesShownForSessionCount)?n:0)+1,scrollControllerHasDisplayed:o.mWebSignupModal.scrollControllerHasDisplayed,modalHasShown:!0,modal:{isShown:!0,displayProps:{headingType:t.payload.isContextualFollowEnabled?"follow":"none",trigger:{attributionLabel:t.payload.isIdeaPin?"click_idea_pin_follow":"click_follow",reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP"},allowCloseOnOutsideClick:!0}}})})}}),shouldShowFloatingBanner:{id:"mobile_floating_banner_trigger",evaluate:function(e){var n=e.checkExperiment;return!(null==n?void 0:n("pc_no_navigational_upsell").anyEnabled)},getNextState:function(e){return e.state}}},x={desktop:U,mobile:k}},671220:function(e,n,t){t.d(n,{dn:function(){return B},UA:function(){return J},ub:function(){return es},EH:function(){return eg},Ik:function(){return M},qH:function(){return eR},mV:function(){return q},OU:function(){return m},Gh:function(){return b},LL:function(){return ey},Li:function(){return e_},jB:function(){return ei},G5:function(){return ef},CC:function(){return ez},F8:function(){return eL},Ue:function(){return Y},kQ:function(){return W},h4:function(){return Q},g_:function(){return z},t:function(){return e2},rA:function(){return D},BF:function(){return em},aj:function(){return eZ},qD:function(){return eG},IS:function(){return eY},it:function(){return G},Yr:function(){return K},Vi:function(){return V},by:function(){return S},wK:function(){return et},i8:function(){return P},K7:function(){return h},fC:function(){return eA},GY:function(){return eN},uy:function(){return I},HK:function(){return y},f$:function(){return en},qs:function(){return ee},vY:function(){return ep},yC:function(){return eV},Fy:function(){return j},QG:function(){return C},OX:function(){return E},WE:function(){return eE},CH:function(){return eK},qT:function(){return w},Dk:function(){return ec},Bh:function(){return $},qq:function(){return eJ},Nx:function(){return U},$S:function(){return k},Lu:function(){return er},k7:function(){return eF},Qm:function(){return ej},Pp:function(){return N},Sy:function(){return eu},b9:function(){return eS},z1:function(){return el},$y:function(){return _},tP:function(){return L},Zr:function(){return A},sg:function(){return ea},QC:function(){return eD},Hm:function(){return ew},uV:function(){return ex},FV:function(){return eP},o9:function(){return eW},MZ:function(){return e0},V9:function(){return X},AS:function(){return g},kd:function(){return R},pp:function(){return v},QA:function(){return eb},tW:function(){return eI},v2:function(){return eU},Jw:function(){return e$},w$:function(){return ed},Pu:function(){return eQ},gU:function(){return e3},cD:function(){return eO},P9:function(){return x},YT:function(){return eX},pZ:function(){return eB},dL:function(){return eh},XE:function(){return eM},Ff:function(){return eq},tA:function(){return Z},TQ:function(){return eo},Q4:function(){return O},gH:function(){return F},aJ:function(){return H},C5:function(){return ev},Aw:function(){return eH},xY:function(){return eC},Dw:function(){return e1},Bi:function(){return T},ap:function(){return ek},ht:function(){return eT},mX:function(){return f}});var o=t(95664),a=t(935833),i=t(184285),r=t(432414),l=function(e){var n,t,o=e.modal,a=e.mWebSignupModal,i=e.appUpsells;return!!(o.isShown||a.modal.isShown||(null==(n=i.learningUpsell)?void 0:n.isShown)||(null==(t=i.iabAppUpsell)?void 0:t.isShown))},u=t(932921),s=t(767415);function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,o)}return t}function p(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?c(Object(t),!0).forEach(function(n){var o,a;o=n,a=t[n],(o=function(e){var n=function(e,n){if("object"!=d(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var o=t.call(e,n||"default");if("object"!=d(o))return o;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==d(n)?n:n+""}(o))in e?Object.defineProperty(e,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[o]=a}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):c(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var _="PROCESS_MOBILE_NAVIGATION_CHANGE",m="SET_UPSELL_REASON",v="UPS_EVENT_PIN_VIEW",g="UPS_EVENT_PIN_SAVE",h="UPS_EVENT_DESKTOP_MODAL_SHOW",b="UPS_EVENT_DESKTOP_MODAL_DISMISSED",f="CLICK_CLOSE_UP_CONTEXT_MENU_SAVE_BUTTON",S="CLICK_CLOSE_UP_CONTEXT_MENU_DOWNLOAD_BUTTON",w="TRIGGER_SCROLL_DOWN_UPSELL",y="CLEAR_SCROLL_DOWN_UPSELL",O="DISMISS_BOTTOM_RIGHT_BANNER",P="TRIGGER_SAVE_EDUCATION_POPOVER",C="CLEAR_SAVE_EDUCATION_POPOVER",E="TRIGGER_RELATED_PINS_GRADIENT_UPSELL",I="CLEAR_RELATED_PINS_GRADIENT_UPSELL",L="TRIGGER_REPLY_TO_SENDER_SHEET",U="CLEAR_REPLY_TO_SENDER_SHEET",k="CLICK_CLOSEUP_UPSELL",x="CLICK_CONTEXT_MENU_SAVE_BUTTON_UPSELL",N="CLICK_CONTEXT_MENU_DOWNLOAD_BUTTON_UPSELL",T="CLICK_FOLLOW_BUTTON_UPSELL",M="CLICK_FOLLOWING_BUTTON_UPSELL",D="CLICK_FOLLOWERS_BUTTON_UPSELL",R="CLICK_COMMENT_COMPOSER_UPSELL",A="CLICK_PIN_LINK_UPSELL",G="CLICK_RELATED_PIN_OPEN_LINK_UPSELL",F="RECORD_NAVIGATIONAL_PAGE",q="SET_INITIAL_SESSION_CONTEXT",W="UPDATE_LATEST_L1_VERTICAL",B="RESET_UPSELL_TRIGGER_STATE",H="RECORD_SOCIAL_PIN_LANDING_PAGE",j="TRIGGER_SOCIAL_DELAY_MODAL",V="TRIGGER_SOCIAL_SCROLL_MODAL",K="SHOW_MOBILE_SIGNUP_MODAL",Z="DISMISS_MOBILE_SIGNUP_MODAL",Q="SET_MOBILE_SIGNUP_MODAL_TOP_INTEREST",Y="INCREMENT_UPSELL_ELIGIBLE_NAVIGATION_COUNT",X="HIDE_UNAUTH_SHARING_MODALS",J="SHOW_UNAUTH_SHARING_MODALS",$="RESTORE_FROM_LOCAL_STORAGE",z="MAIN_PIN_IMAGE_CLICK_MOBILE",ee="ON_LAND_UPSELL_MOBILE",en="SET_LEARNING_UPSELL_VISIBILITY",et="CLICK_MOBILE_CONTEXT_MENU_DOWNLOAD_BUTTON_UPSELL",eo="DISMISS_MOBILE_FLOATING_UPSELL",ea="CLICK_FOLLOW_BUTTON_UPSELL_MOBILE",ei="INCREMENT_PIN_SAVE_COUNT",er="DECREMENT_PIN_SAVE_COUNT",el="INCREMENT_UNAUTH_CLICKTHROUGH_COUNT",eu="SET_UNAUTH_DOWNLOAD_COUNT",es="UPS_EVENT_PIN_SAVE_MOBILE",ed="SET_REFERRED_APP_UPSELL_STATE",ec=function(e){return{type:$,payload:{upsellEligibleNavigationCount:e}}},ep=function(e){return{type:m,payload:{upsellReason:e}}},e_=function(e,n,t,o,a){return{type:v,payload:{pinId:e,seoUrl:n,componentType:t,viewParameter:o,checkExperiment:a}}},em=function(e,n){return{type:g,payload:{pinId:e,attributionLabel:n}}},ev=function(){return{type:b}},eg=function(){return{type:O}},eh=function(e){return{type:h,payload:{displayProps:e}}},eb=function(){return{type:k}},ef=function(e,n,t){return{type:x,payload:{pinId:e,attributionLabelSource:n,signupToLoginExpGroup:t}}},eS=function(e,n){return{type:T,payload:{isIdeaPin:e,isContextualFollowEnabled:n}}},ew=function(e,n,t,o){return{type:f,payload:{pinId:e,attributionLabelSource:n,signupToLoginExpGroup:t,checkExperiment:o}}},ey=function(e){var n=e.pinId,t=e.attributionLabelSource,o=e.downloadAllowedCallback;return function(e){var i=e.checkExperiment;return e.sessionContext,function(e,r){var s,d,c,p,_=r(),m=(0,u.H)(i,{downloadCount:null!=(s=null==(d=_.upsell)?void 0:d.unauthDownloadCount)?s:0,upsellDispatch:e,isAuthenticated:null!=(c=null==(p=_.session)?void 0:p.isAuthenticated)&&c}),v=m.limitReached,g=m.oldCount,h=m.newCount;(0,a.My)("dweb.unauth.context_menu.download_image",{attributionLabelSource:t,limitReached:v,oldCount:g,newCount:h}),e({type:S,payload:{pinId:n,attributionLabelSource:t,limitReached:v,checkExperiment:i}}),l(r().upsell)||o()}}},eO=function(e){var n=e.pinId,t=e.attributionLabelSource,o=e.inImmediateUpsellGroup,i=e.inDwebSwapDownloadUpsellExp,r=e.downloadAllowedCallback,s=e.showDownloadIconForRelatedPins,d=e.inDwebDownloadCTAExp;return function(e){var c=e.checkExperiment;return e.sessionContext,function(e,p){var _,m,v,g,h=p(),b=(0,u.H)(c,{downloadCount:null!=(_=null==(m=h.upsell)?void 0:m.unauthDownloadCount)?_:0,upsellDispatch:e,isAuthenticated:null!=(v=null==(g=h.session)?void 0:g.isAuthenticated)&&v}),f=b.limitReached,S=b.oldCount,w=b.newCount;s?(0,a.My)("dweb.unauth.action_bar.download_image",{attributionLabelSource:t,limitReached:f,oldCount:S,newCount:w}):d?(0,a.My)("dweb.unauth.download_cta.download_image",{attributionLabelSource:t}):i?(0,a.My)("dweb.unauth.swap_download_upsell.download_image",{attributionLabelSource:t}):(0,a.My)("dweb.unauth.context_menu.download_image",{attributionLabelSource:t,limitReached:f,oldCount:S,newCount:w}),e({type:N,payload:{pinId:n,attributionLabelSource:t,limitReached:f,inImmediateUpsellGroup:o,inDwebSwapDownloadUpsellExp:i,checkExperiment:c}}),l(p().upsell)||r()}}},eP=function(){return{type:M}},eC=function(){return{type:D}},eE=function(){return{type:R}},eI=function(e){return{type:A,payload:{count:e}}},eL=function(){return{type:G}},eU=function(e,n){return function(t){var o=t.checkExperiment,a=t.sessionContext;return function(t){t({type:F,payload:{pageUniqueKey:e,containerPage:n,checkExperiment:o,sessionContext:a}})}}},ek=function(e){return{type:q,payload:{sessionContext:e}}},ex=function(e){return{type:W,payload:{l1Vertical:e}}},eN=function(e,n){return{type:H,payload:{inviter:e,containerPage:n}}},eT=function(e){return function(n){var t=n.checkExperiment;return function(n){n({type:j,payload:{containerPage:e,checkExperiment:t}})}}},eM=function(e){return function(n){var t=n.checkExperiment;return function(n){n({type:V,payload:{containerPage:e,checkExperiment:t}})}}},eD=function(){return{type:C}},eR=function(){return function(e){var n=e.checkExperiment;return function(e){e({type:E,payload:{checkExperiment:n}})}}},eA=function(){return{type:I}},eG=function(){return function(e){var n=e.checkExperiment;return e.sessionContext,function(e){var t=((null==n?void 0:n("ce_mweb_unauth_social_feature_education"))||{}).group;null!=t&&t.startsWith("enabled_group_board")?e(function(e){e({type:P,payload:{checkExperiment:n}})}):null!=t&&t.startsWith("enabled_reply_to_sender")&&e(function(e){e({type:L,payload:{checkExperiment:n}})})}}},eF=function(){return{type:U}},eq=function(e){return{type:K,payload:e}},eW=function(){return{type:Z}},eB=function(e){return{type:Q,payload:{topInterest:e}}},eH=function(){return{type:Y}},ej=function(){return{type:X}},eV=function(){return{type:J}},eK=function(e){return function(n){var t=n.checkExperiment,o=n.sessionContext;return function(n,i){n({type:_,payload:p(p({},e),{},{checkExperiment:t,sessionContext:o})}),l(i().upsell)||(0,a.My)("mweb.nav.upsell.show.".concat(e.currentNavigationCount))}}},eZ=function(e){return function(n){var t=n.checkExperiment,l=n.sessionContext;return function(n,u){var d,c,p,_=u().upsell,m=l.country,v=l.userAgent,g=null==(p=r.YM.mobile.shouldShowOnLandUpsell)?void 0:p.evaluate({checkExperiment:t,isUpsellEnabledGlobally:(0,i.e_)({isModalShown:null!=(d=_.mWebSignupModal.modal.isShown)&&d,isUnauthSharingModalsShown:null!=(c=_.mWebSignupModal.isUnauthSharingModalsShown)&&c,modalHasShown:!!_.mWebSignupModal.modalHasShown,country:m,userAgent:v}),hasSeenNavUpsell:_.mWebSignupModal.modalHasShown,location:e.location,isPaid:e.isPaid,isSocial:e.isSocial,isDirect:e.isDirect,isSEO:e.isSEO,userAgent:v,showUnauthMwebSocialDefaultModalUpsell:e.showUnauthMwebSocialDefaultModalUpsell,isSocialInAppBrowser:o.ry,session:l});g.shouldShowModal&&g.modalConfig&&((0,a.My)("mweb.nav.upsell.show.0"),g.showUnauthMwebSocialUpsell&&(0,s.nP)("unauth.mweb.social.pin.upsell",{sampleRate:1}),n({type:ee,payload:{decision:g,checkExperiment:t}}))}}},eQ=function(e){return function(n){var t=n.checkExperiment,o=n.sessionContext;return function(n,i){var l,u,s,d=!!(null!=(l=i().upsell.appUpsells.learningUpsell)&&l.isShown),c=null==(u=r.YM.mobile.shouldShowMainPinImageNavigationalModal)?void 0:u.evaluate({checkExperiment:t,session:o,isUpsellEnabledGlobally:e.upsellContext.isUpsellEnabledGlobally(),isModalCurrentlyShown:e.upsellContext.isModalShown,learningUpsellScenario:e.learningUpsellScenario}),p=null==(s=r.YM.mobile.shouldShowMainPinImageAppUpsell)?void 0:s.evaluate({learningUpsellScenario:e.learningUpsellScenario,hasConversionUpsell:!!c,isLearningAppUpsellShown:d});c?(0,a.My)("mweb.nav.upsell.show.main_pin_image_click"):p.shouldToggleAppUpsell?p.currentlyShowing?e.trackInteraction({action:"dismiss",item:"learning-upsell"}):e.trackInteraction({action:"click",item:"learning-upsell"}):e.onImageClick(),n({type:z,payload:{conversionDecision:c,appUpsellDecision:p,checkExperiment:t,pinId:e.pinId}})}}},eY=function(e){var n=e.isShown,t=e.isDismissedByUser;return{type:en,payload:{isShown:n,isDismissedByUser:void 0!==t&&t}}},eX=function(e){var n=e.pinId,t=e.attributionLabelSource,o=e.inImmediateUpsellGroup,i=e.inMwebDownloadCTAExp,r=e.showDownloadCloseupIcon,s=e.downloadAllowedCallback;return function(e){var d=e.checkExperiment;return e.sessionContext,function(e,c){var p,_,m,v,g=c(),h=(0,u.H)(d,{downloadCount:null!=(p=null==(_=g.upsell)?void 0:_.unauthDownloadCount)?p:0,upsellDispatch:e,isAuthenticated:null!=(m=null==(v=g.session)?void 0:v.isAuthenticated)&&m}),b=h.limitReached,f=h.oldCount,S=h.newCount;i?(0,a.My)("mweb.unauth.download_cta.download_image",{attributionLabelSource:t}):r?(0,a.My)("mweb.unauth.download_closeup_icon.download_image",{attributionLabelSource:t}):(0,a.My)("mweb.unauth.context_menu.download_image",{attributionLabelSource:t,limitReached:b,oldCount:f,newCount:S}),e({type:et,payload:{pinId:n,attributionLabelSource:t,limitReached:b,inImmediateUpsellGroup:o,inMwebDownloadCTAExp:i,showDownloadCloseupIcon:r,checkExperiment:d}}),l(c().upsell)||s()}}},eJ=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.isDismissedByUser;return{type:eo,payload:{isDismissedByUser:void 0!==n&&n}}},e$=function(e,n){return{type:ea,payload:{isIdeaPin:e,isContextualFollowEnabled:n}}},ez=function(){return{type:er}},e0=function(){return{type:el}},e1=function(e){return{type:eu,payload:{count:e}}},e2=function(e){return function(n){var t=n.checkExperiment;return n.sessionContext,function(n,o){var a,i=o().upsell;null!=(a=r.YM.mobile.shouldAllowUnauthSave)&&a.evaluate({checkExperiment:t,isPPMAndroidUnauthExperience:e.isPPMAndroidUnauthExperience,isFromUnauthContextMenu:e.isFromUnauthContextMenu,currentUnauthSaves:e.unauthSavedPinsStore.pins.length})&&!i.mWebSignupModal.modal.isShown?(e.unauthSavedPinsStore.save({id:e.pinId,nodeId:e.nodeId,imageUrl:e.getPinGifOrImageSrc({imagesUrls:e.imagesUrls,embedSrc:e.embedSrc,embedType:e.embedType,excludeOriginals:!e.isBot&&!e.isSocialBot})}),n({type:ei}),e.handleShowNavFooter(n,e.forceShowNavFooter,e.isNavBarHidden,e.setForceShowNavFooter),e.successCallback&&e.successCallback()):n({type:es,payload:{attributionLabel:e.isFromUnauthContextMenu?e.attributionLabel||"click_save_button_on_closeup":"click_save_button_with_max_unauth_saves",headingType:e.isFromUnauthContextMenu?"save":"extended_save_out_of_quota",pinId:e.pinId,checkExperiment:t}})}}},e3=function(e){return{type:ed,payload:{isShown:e.isShown,appUpsellType:e.appUpsellType,isBlocking:e.isBlocking}}}},270922:function(e,n,t){t.d(n,{A4:function(){return u},T9:function(){return c},qo:function(){return l},y1:function(){return r}});var o=t(95664),a=t(969809),i=t(238957),r=function(e){return e?(0,a.Z)(e.toUpperCase()):"OTHER"},l=function(e){return e.isPaid?"paid":e.isInvite?"invite":e.isSocial?"social":e.isSEO?"seo":e.utmSource?"utm_".concat(e.utmSource):"direct"},u=function(e){return e&&"string"==typeof e?(0,o.$K)(e)?"pinterest":(0,o.dh)(e)?"instagram":/wechat|micromessenger/i.test(e)?"wechat":(0,o.ry)(e)||/facebook|fbav|fban|tiktok|twitter|line/i.test(e)?"social":"none":"none"},s=function(e){var n=t(173874),o=n.isAnyTodayPage,a=n.isHubOrIdeaPage,i=n.isBoardSectionPage,r=n.isBoardPage,l=n.isCloseupPage,u=n.isHomePage,s=n.isSearchPage,d=n.isTopicPage,c=t(138482).Z,p={pathname:e};return o(p)?"today":a(p)?"ideas":i(p)?"section":r(p)?"board":l(p)?"closeup":u(p)?"home":c(p)?"profile":s(p)?"search":d(p)?"topic":""},d=function(e){var n=e.ts;if(!n||0===n)return 0;var t=new Date,o=new Date(n);return Math.max(Math.floor(Number(((t.getTime()-o.getTime())/864e5).toFixed(2))),0)},c=function(e,n,t,o){var a,c=(null==e?void 0:e.countryFromHostName)||(null==e?void 0:e.country)||"",p=(null==e||null==(a=e.userAgent)?void 0:a.raw)||("undefined"!=typeof navigator?navigator.userAgent:""),_=u(p),m=s(o),v=(0,i.iU)();return{country:c,userAgent:p,referrer:(null==e?void 0:e.referrerFromHeader)||(null==e?void 0:e.referrerFromCookie)||"",unauthID:(null==e?void 0:e.unauthId)||"",region:r(c),channel:l(n),iab:_,isIAB:"instagram"===_||"wechat"===_||"social"===_,landingPageType:m,deviceType:t,revisitationState:v,revisitationCount:v.count,daysSinceLastVisit:d(v)}}},932921:function(e,n,t){t.d(n,{H:function(){return u},Z:function(){return r}});var o=t(935833),a=t(671220);function i(e,n,t,o,a,i,r){try{var l=e[i](r),u=l.value}catch(e){return void t(e)}l.done?n(u):Promise.resolve(u).then(o,a)}function r(e,n){return l.apply(this,arguments)}function l(){var e;return e=regeneratorRuntime.mark(function e(n,t){var a,i,r,l,u,s,d,c,p,_,m,v,g;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.filename,i=n.imgSrc,r=n.imageDownloadSuccessCallback,l=n.category,u=n.pinId,s=n.viewParameter,d=n.viewType,p=void 0!==(c=n.isUnauth)&&c,m=void 0===(_=n.platform)?"web":_,v=n.expName,g=n.expGroup,"undefined"!=typeof window){e.next=3;break}return e.abrupt("return",Promise.resolve());case 3:if((0,o.My)("web.download.click",{category:l||"no_category",authType:p?"unauth":"auth",platform:m,viewType:d,expName:v,expGroup:g}),t({event_type:82,object_id_str:u,view_type:d||3,view_parameter:s||139}),!(i&&document)){e.next=9;break}return e.abrupt("return",fetch(i,{headers:new Headers({Origin:window.location.origin}),mode:"cors"}).then(function(e){return e.blob()}).then(function(e){var n,t,i=document.createElement("a");i.href=window.URL.createObjectURL(e),a&&i.setAttribute("download",a.replace(".","_")),i.style.display="none",null==(n=document.body)||n.appendChild(i),i.click(),null==(t=document.body)||t.removeChild(i),(0,o.My)("web.download.success",{category:l||"no_category",authType:p?"unauth":"auth",platform:m,viewType:d,expName:v,expGroup:g}),null==r||r()}).catch(function(){throw(0,o.My)("web.download.failure",{category:l||"no_category",authType:p?"unauth":"auth",platform:m,viewType:d,expName:v,expGroup:g}),Error("Download image error")}));case 9:return e.abrupt("return",Promise.resolve());case 10:case"end":return e.stop()}},e)}),(l=function(){var n=this,t=arguments;return new Promise(function(o,a){var r=e.apply(n,t);function l(e){i(r,o,a,l,u,"next",e)}function u(e){i(r,o,a,l,u,"throw",e)}l(void 0)})}).apply(this,arguments)}var u=function(e,n){var t=n||{},o=t.downloadCount,i=t.upsellDispatch,r=t.isAuthenticated,l=t.updateDownloadCount;if(r)return{limitReached:!1,oldCount:0,newCount:0};if(e("unuath_download_paywalled").anyEnabled||e("unauth_combined_download_exp").anyEnabled)return{limitReached:!0,oldCount:0,newCount:0};var u=void 0===o?0:o,s=u>=1,d=s?u:u+1;return u!==d&&i&&(i((0,a.Dw)(d)),null==l||l()),{limitReached:s,oldCount:u,newCount:d}}},163691:function(e,n){function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,o)}return t}function a(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?o(Object(a),!0).forEach(function(n){var o,i;o=n,i=a[n],(o=function(e){var n=function(e,n){if("object"!=t(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var a=o.call(e,n||"default");if("object"!=t(a))return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==t(n)?n:n+""}(o))in e?Object.defineProperty(e,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[o]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))})}return e}n.Z=function(e){return a(a({},e),{},{ts:Date.now()})}},238957:function(e,n,t){t.d(n,{K7:function(){return u},Vd:function(){return d},WT:function(){return l},iU:function(){return s}});var o=t(4533),a=t(994507),i=t(34550),r=t(163691),l=18e5,u=a.dm,s=function(){try{var e,n=null!=(e=(0,i.M0)().getItem(o.SI))?e:{},t=n.count,r=n.time,l=n.ts;if("number"==typeof t&&"number"==typeof r&&"number"==typeof l)return{count:t,time:r,ts:l};throw Error("Invalid revisitation data")}catch(e){return(0,a.dm)()}},d=function(e){(0,i.M0)().setItem(o.SI,(0,r.Z)(e))}},658375:function(e,n,t){t.d(n,{C:function(){return r},P:function(){return i}});var o=t(173874),a=t(767415),i=function(){return!1},r=function(e){(0,o.isDiscoverArticlePage)(e)&&!i()&&(0,a.nP)("mobile_signup_modal.rules.suppress_for_discover_article",{flushImmediate:!0,sampleRate:1})}}}]);